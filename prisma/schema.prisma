generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
}

model categoria {
  id_categoria   Int       @id @default(autoincrement()) @db.UnsignedInt
  nome_categoria String    @db.VarChar(255)
  produto        produto[]
}

model endereco {
  id_endereco Int      @id @default(autoincrement()) @db.UnsignedInt
  cep         String   @db.Char(8)
  cidade      String   @db.VarChar(100)
  bairro      String   @db.VarChar(100)
  rua         String   @db.VarChar(100)
  complemento String   @db.VarChar(255)
  numero      BigInt
  pessoa      pessoa[]
}

model item_pedido {
  id_itemPedido  BigInt  @id @default(autoincrement()) @db.UnsignedBigInt
  id_pedido      Int     @db.UnsignedInt
  id_produto     Int     @db.UnsignedInt
  quantidade     BigInt
  preco_unitario Float
  sub_total      Float
  pedido         pedido  @relation(fields: [id_pedido], references: [id_pedido], onDelete: NoAction, onUpdate: NoAction, map: "fk_item_pedido")
  produto        produto @relation(fields: [id_produto], references: [id_produto], onDelete: NoAction, onUpdate: NoAction, map: "fk_item_produto")

  @@index([id_pedido], map: "item_pedido_id_pedido_foreign")
  @@index([id_produto], map: "item_pedido_id_produto_foreign")
}

model pedido {
  id_pedido   Int           @id @default(autoincrement()) @db.UnsignedInt
  id_cliente  Int           @db.UnsignedInt
  data_pedido DateTime      @db.Date
  total       Float
  item_pedido item_pedido[]
  pessoa      pessoa        @relation(fields: [id_cliente], references: [id_pessoa], onDelete: NoAction, onUpdate: NoAction, map: "fk_pedido_cliente")

  @@index([id_cliente], map: "pedido_id_cliente_foreign")
}

model pessoa {
  id_pessoa   Int      @id @default(autoincrement()) @db.UnsignedInt
  nome        String   @db.VarChar(100)
  cpf         String   @db.Char(11)
  telefone    String   @db.Char(13)
  id_usuario  Int      @db.UnsignedInt
  id_endereco Int      @db.UnsignedInt
  pedido      pedido[]
  endereco    endereco @relation(fields: [id_endereco], references: [id_endereco], onDelete: NoAction, onUpdate: NoAction, map: "fk_pessoa_endereco")
  usuario     usuario  @relation(fields: [id_usuario], references: [id_usuario], onDelete: NoAction, onUpdate: NoAction, map: "fk_pessoa_usuario")

  @@index([id_endereco], map: "pessoa_id_endereco_foreign")
  @@index([id_usuario], map: "pessoa_id_usuario_foreign")
}

model produto {
  id_produto        Int                 @id @default(autoincrement()) @db.UnsignedInt
  nome              String              @db.VarChar(100)
  descricao         String              @db.VarChar(255)
  preco             Float
  quantidade        Int
  imagem            String              @db.VarChar(255)
  id_categoria      Int                 @db.UnsignedInt
  item_pedido       item_pedido[]
  categoria         categoria           @relation(fields: [id_categoria], references: [id_categoria], onDelete: NoAction, onUpdate: NoAction, map: "fk_produto_categoria")
  produto_historico produto_historico[]

  @@index([id_categoria], map: "produto_id_categoria_foreign")
}

model produto_historico {
  id_historico BigInt   @id @default(autoincrement()) @db.UnsignedBigInt
  data         DateTime @db.DateTime(0)
  operacao     String   @db.VarChar(255)
  valor_antigo String   @db.VarChar(255)
  valor_atual  String   @db.VarChar(255)
  id_produto   Int      @db.UnsignedInt
  campo_bigint String   @db.VarChar(255)
  produto      produto  @relation(fields: [id_produto], references: [id_produto], onDelete: NoAction, onUpdate: NoAction, map: "fk_historico_produto")

  @@index([id_produto], map: "produto_historico_id_produto_foreign")
}

model usuario {
  id_usuario    Int                   @id @default(autoincrement()) @db.UnsignedInt
  email         String                @db.VarChar(150)
  senha         BigInt
  administrador usuario_administrador
  pessoa        pessoa[]
}

enum usuario_administrador {
  EMPTY_ENUM_VALUE @map("")
}
